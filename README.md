# Malware-Analysis-Cheat-Sheet

## Summary
This document was designed to be a useful, practical asset for those looking to perform Malware Analysis step by step by a methodology.
This methodology based on the book "Learning Malware Analysis" by Monnappa K A and my professional experience.

## Table of Contents

* [The Starting Point Chart](https://github.com/ptsec/Malware-Analysis/blob/master/chart-01.png)
* [Basic Static Analysis](https://github.com/ptsec/Malware-Analysis/#basic-static-analysis)
* [Basic Dynamic Analysis](https://github.com/ptsec/Malware-Analysis/#basic-dynamic-analysis)
* [Advanced Static Analysis](https://github.com/ptsec/Malware-Analysis/#advanced-static-analysis)
* [Advanced Dynamic Analysis](https://github.com/ptsec/Malware-Analysis/#advanced-dynamic-analysis)


## Basic Static Analysis
* ### Get File Hash
  * [PowerShell](https://github.com/ptsec/Malware-Analysis/blob/master/get-hash.ps1) 
  * [Python](https://github.com/ptsec/Malware-Analysis/blob/master/get-hash.py)
  * [Sigcheck](https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck)
  
* ### Upload The Hash To VirusTotal
  * [VirusTotal](https://www.virustotal.com/gui/home/search) 
  * [Python](https://github.com/ptsec/Malware-Analysis/blob/master/get-hash.py)

* ### Extract Strings
  * [Strings](https://docs.microsoft.com/en-us/sysinternals/downloads/strings)
  * [Stringsfiter](https://github.com/fireeye/stringsifter) 
  
* ### Deobfuscate Strings
   * [Floss](https://github.com/fireeye/flare-floss)
   
* ### COFF Header Information
   * [Understanding COFF](https://tech-zealots.com/malware-analysis/pe-portable-executable-structure-malware-analysis-part-2/) 
   * [CFF Explorer](https://ntcore.com/?page_id=388)
   * [Exeinfo PE](www.exeinfo.xn.pl)
   * [PE Internals](http://www.andreybazhan.com/pe-internals.html)
   * [PPEE PE Explorer](http://mzrst.com/)
   * [PEBrowser Professional](https://download.cnet.com/PEBrowse-Professional-64-bit/3000-2218_4-75176627.html)
   * [PEstudio](https://www.winitor.com/)
      * Inspecting File Dependencies, Imports and Exports - [pefile](https://github.com/erocarrera/pefile)
      *  Examining PE Section Table And Sections 
      *  Examining the Compilation Timestamp 
      * Examining PE Resources - [Resource Hacker](http://www.angusj.com/resourcehacker/)
      
* ### Classifying The Malware   
  * Fuzzyhashing - 
    * [ssdeep](https://ssdeep-project.github.io/ssdeep/) 
    * [Python](https://pypi.org/project/ssdeep/3.2/)
  *  [Import Hash - impash](https://www.fireeye.com/blog/threat-research/2014/01/tracking-malware-import-hashing.html)
     * pestudio
     * python - pefile module
  *   Section Hash 
      * pestudio - section
      * python - pefile module
   * [YARA](https://yara.readthedocs.io/en/stable/)
   
## Basic Dynamic Analysis
* ### Monitoring Tools
  *  Process Inspection - [Process Hacker](http://processhacker.sourceforge.net/)
  * Determining System Interaction - [Process Monitor](https://technet.microsoft.com/en-us/sysinternals/processmonitor.aspx) 
  * Logging System Activities - [Noriben](https://github.com/Rurik/Noriben) 
  *  Capturing Network Traffic - [Wireshark](https://www.wireshark.org/)
  * Simulating Services - [INetSim](https://www.inetsim.org/index.html)

## Advanced Static Analysis
 * ### Code Analysis 
   *  Static Code Analysis (Disassembly) - [IDA]( https://www.hex-rays.com/products/ida/support/)
   * Disassembling Windows API -  [ more about the API function](https://msdn.microsoft.com)
   * [IDAPython](https://leanpub.com/IDAPython-Book)
 * ### Encoding And Decoding 
   * Encoding - [CyberChef](https://github.com/gchq/CyberChef)
   * [ConverterNET](http://www.kahusecurity.com/tools.html)
   * XOR Encoding 
     * [XORSearch by Didier Stevens](https://blog.didierstevens.com/programs/xorsearch/)
     * [Balbuzard](https://github.com/decalage2/balbuzard)
     * [unXOR](https://github.com/tomchop/unxor/#unxor)
     * [brxor.py](https://github.com/REMnux/distro/blob/v6/brxor.py)
     * [NoMoreXOR]( https://github.com/hiddenillusion/NoMoreXOR)
   * Identifying Crypto Signatures - [Signsrch](http://aluigi.altervista.org/mytoolz.htm)
   * Detecting Crypto Constants - [FindCrypt2](http://www.hexblog.com/ida_pro/files/findcrypt2.zip)
   * Detecting Crypto Signatures  - [YARA](https://github.com/x64dbg/yarasigs/blob/master/crypto_signatures.yara)
   * Decrypting In Python - [PyCryto](https://www.dlitz.net/software/pycrypto/)
   * Identifying The OEP - [pestudio](https://www.winitor.com/)
   * Dumping Process Memory - [Scylla](https://github.com/NtQuery/Scylla)
 * ### Memory Forensics
   *  Memory Acquisition
      * [DumpIt](https://my.comae.com/login/) 
      * [RAM Capturer](https://belkasoft.com/ram-capturer)
      * [FTK Imager](https://accessdata.com/product-download)
      * [Memoryze](https://www.fireeye.com/services/freeware/memoryze.html)
      * [Surge Collect](https://www.volexity.com/productsoverview/surge/)
      * [OSForensics](https://www.osforensics.com/osforensics.html)
      * [WinPmem](http://blog.rekall-forensic.com/search?q=winpmem)
   * Memory Image Analysis
     * [Volatility](https://www.volatilityfoundation.org/releases)
     * [Volatility Source Package](https://github.com/volatilityfoundation/volatility/wiki/Installation#recommended-packages)
     *  Volatility plugins
        *  Enumerating Processes - pslist 
        *  Process Overview - [WinObj tool](https://docs.microsoft.com/en-us/sysinternals/downloads/winobj) 
         * Examining the _EPROCESS Structure 
            * [WinDbg](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools)
            * [LiveKD](https://docs.microsoft.com/en-us/sysinternals/downloads/livekd)
        * Listing Hidden Processes - psscan 
        * Process Listing - psxview 
        * Listing DLLs - dlllist 
        * Detecting Hidden DLLs - ldrmodules 
        * Dumping an Executable and DLL - procdump 
        * Listing Network Connections and Sockets - connections 
        * Inspecting Registry - printkey 
        * Investigating Service - svcscan 
        * Extracting Command History - cmdscan\consoles 
    * Detecting Injected Code Using VAD 
        * [Understanding VAD](https://resources.infosecinstitute.com/finding-enumerating-processes-within-memory-part-2/#gref)
        * Getting VAD Information - vadinfo
        * Dumping The Process Memory Region - vaddump 
        * Detecting Injected Code - malfind 
        * [Hollow Process Injection](https://cysinfo.com/7th-meetup-reversing-and-investigating-malware-evasive-tactics-hollow-process-injection/) 
        *  Detecting API Hooks - apihooks 
        *  Listing Kernel Modules - modules/modscan/driverscan  
        * [DeviceTree](http://www.osronline.com/article.cfm?article=97)
        * [IRP](https://www.osronline.com/article.cfm?article=199)
        * [About Callback Objects](https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/callback-objects)
        * [Kernel Callback Functions](https://www.codemachine.com/article_kernel_callback_functions.html)
        * [About kernel timer](https://docs.microsoft.com/en-us/windows-hardware/drivers/kernel/timer-objects-and-dpcs)
     
## Advanced Dynamic Analysis
  * ### Debugging
    * [x64dbg](https://x64dbg.com/#start)
    * IDA, IDAPython
    * Debugging a .NET Application  - [dnSpy](https://github.com/0xd4d/dnSpy)
